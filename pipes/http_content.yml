name: http_content
input:
  table: services
  filter:
    service: http
cmd: TMP=$(mktemp); ffuf -w ./resources/http_wordlist.txt -u ${.input.url}/FUZZ -ac -recursion -of ejson -s -o $TMP > /dev/null && jq -M -c '.results[]' $TMP
output:
  table: results
  ident: ${.outputJson.url}|${.outputJson.status}|${.outputJson.length}
  data:
    service: http
    url: ${.outputJson.url}
    status: ${.outputJson.status}
    length: ${.outputJson.length}
    words: ${.outputJson.words}
    lines: ${.outputJson.lines}
interval: 48h
worker: 2
