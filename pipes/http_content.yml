name: http_content
input: services
cmd: TMP=$(mktemp); ffuf -w ./resources/http_wordlist.txt -u ${.input.data.http_detect.url}/FUZZ -ac -recursion -of ejson -s -o $TMP > /dev/null && jq -M -c '.results[]' $TMP
filter:
  service: http
output: results
ident: ${.outputJson.url}|${.outputJson.status}|${.outputJson.length}
fields:
  target_name: ${.input.target_name}
  hostname: ${.input.hostname}
  service: http
data:
  url: ${.outputJson.url}
  status: ${.outputJson.status}
  length: ${.outputJson.length}
  words: ${.outputJson.words}
  lines: ${.outputJson.lines}
interval: 48h
worker: 2
